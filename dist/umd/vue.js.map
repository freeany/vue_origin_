{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/dep.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/parse-html.js","../../src/compiler/index.js","../../src/observer/watcher.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/init.js","../../src/vdom/create-element.js","../../src/render.js","../../src/initGlobalAPI/index.js","../../src/index.js"],"sourcesContent":["export function isObject(data) {\r\n    return typeof data === 'object' && data !== null\r\n}\r\n\r\nexport function def(data, key, value) {\r\n    Object.defineProperty(data, key, {\r\n        enumerable: false,\r\n        configurable: false,\r\n        value\r\n    })\r\n}\r\n\r\nconst LIFECYCLE_HOOKS = [\r\n    'beforeCreate',\r\n    'created',\r\n    'beforeMount',\r\n    'mounted',\r\n    'beforeUpdate',\r\n    'upadted',\r\n    'beforeDestroy',\r\n    'destroyed'\r\n]\r\nfunction mergeHook(parent, child) {\r\n    if(child) { // 新的有\r\n        if(parent) {  // 如果新的有老得也有\r\n            return parent.concat(child)\r\n        }else {\r\n            return [child] // 首次肯定都没有，所以返回一个数组过去，所以下次的parent可以用concat方法。\r\n        }\r\n    }else { // 新的没有，老得有\r\n        return parent\r\n    }\r\n}\r\nlet strats = {}\r\nLIFECYCLE_HOOKS.forEach(hook => {\r\n    strats[hook] = mergeHook\r\n})\r\n// 合并两个对象。使用Object。assign 或者 {...} 只会将后者中的相同key直接覆盖前者中的相同key。而这个是对对象中的key进行合并。不是直接覆盖。\r\n// 都有同样的属性,且其值为基本数据类型，以child的为主， parent的扔掉\r\n// 都有同样的属性,且其值为引用数据类型，将这两个对象合并，该引用数据类型中有相同的值仍然以上个条件为主。\r\nexport function mergeOptions(parent, child) {\r\n    const options = {}\r\n    \r\n    // 需要对 parent对象进行遍历\r\n    for(let key in parent) {\r\n        mergeField(key)\r\n    }\r\n    // 也需要对child进行遍历\r\n    for(let key in child) {\r\n        // 如果合并过了(上面的走完了才会走到这)， 那么就不需要合并了\r\n        if(!parent.hasOwnProperty(key)) {\r\n            mergeField(key)\r\n        }\r\n    }\r\n    // 默认的合并策略， 有些属性需要有特殊的合并方式，生命周期的合并\r\n    function mergeField(key) {\r\n        if(strats[key]) {\r\n            return options[key] = strats[key](parent[key], child[key])\r\n        }\r\n        // 如果parent和child都是引用数据类型\r\n        if(typeof parent[key] === 'object' && typeof child[key] === 'object') {\r\n            options[key] = {\r\n                ...parent[key],\r\n                ...child[key]\r\n            }\r\n            // 如果儿子没有，那么就直接将parent的值放给options。\r\n        } else if(child[key] == null) {\r\n            options[key] = parent[key]\r\n        }else {\r\n            // 如果是不是上面的情况\r\n            options[key] = child[key]\r\n        }\r\n    }\r\n    return options\r\n}","\r\n// 我要重写数组的那7个方法， push、shift、unshift、pop、reverse、sort、splice  会导致数组本身发生变化\r\n\r\nlet oldArrayMethods = Array.prototype\r\nexport const arrayMethods = Object.create(oldArrayMethods)\r\n/*\r\narrayMethods = {\r\n    constructor: ƒ Array()\r\n    pop: ƒ pop()\r\n    push: ƒ push()\r\n    reverse: ƒ reverse()\r\n    shift: ƒ shift()\r\n    slice: ƒ slice()\r\n    sort: ƒ sort()\r\n    splice: ƒ splice()\r\n    unshift: ƒ unshift()\r\n    ...\r\n}\r\n  当我们定义的数据是数组的时候调用这些方法会到这里来找，这么做的好处是我们掌握了调用这些方法的控制权，可以对这个对象中的方法进行重写。 而且对于其他的方法并不影响其原有逻辑。  记住：拿到了控制权就可以加入自己的逻辑\r\n */\r\n\r\n/* \r\n    我们的目的是什么？\r\n    是让用户 插入/修改的值也获取数据相应的效果\r\n    但是我们还需要调用数组原有的方法\r\n    我们 需要在这调用这七个方法中加入自己的逻辑处理。然后处理完毕在调用数组原有的方法\r\n*/\r\n\r\nconst methods = [\r\n  \"push\",\r\n  \"shift\",\r\n  \"unshift\",\r\n  \"pop\",\r\n  \"reverse\",\r\n  \"sort\",\r\n  \"splice\"\r\n]\r\n\r\nmethods.forEach(method => {\r\n  //  定义方法重写数组原有的方法\r\n  // 重新定义arrayMethods中的方法\r\n  arrayMethods[method] = function (...args) {\r\n\r\n    let inserted; // 当前用户插入的元素\r\n    switch (method) {\r\n      case 'push':\r\n      case 'unshift':\r\n        inserted = args\r\n        break\r\n      case 'splice':  // splice 有删除、修改、新增的功能。我们需要对新增/修改的数据进行劫持。\r\n        inserted = args.slice(2)\r\n        break\r\n    }\r\n    this.__ob__.observerArray(inserted)\r\n    // 调用原生方法走原来的逻辑\r\n    let result = Array.prototype[method].apply(this, args)\r\n    // 派发更新\r\n    this.__ob__.dep.notify()\r\n    return result\r\n  }\r\n\r\n})\r\n","// dep存的是watcher。dep收集依赖。\r\n/* \r\n    wathcer 和 dep的关系\r\n    一个watcher 对应n个dep\r\n    一个dep 对应多个watcher\r\n*/\r\nlet id = 0\r\nclass Dep {\r\n    constructor() {\r\n        this.id = id++\r\n        this.subs = []\r\n    }\r\n    depend() {\r\n        // 如果在页面中多次使用了变量，那么会存放重复的watcher， 所以需要将Dep与watcher进行相互记忆。\r\n        // this.subs.push(Dep.target) // 不合适\r\n        Dep.target.addDep(this) // 记住当前\r\n    }\r\n    addSubs(watcher) {\r\n        this.subs.push(watcher)\r\n    }\r\n    notify() {\r\n        this.subs.forEach(watcher => watcher.update())\r\n    }\r\n\r\n}\r\n\r\n// 一个变量可能引用了多个watcher\r\nlet stack = []\r\nexport function pushTarget(watcher) {\r\n    Dep.target = watcher // 将渲染watcher存放到Dep.target\r\n    stack.push(watcher)\r\n}\r\n\r\nexport function popTarget() {\r\n    stack.pop()\r\n    Dep.target = stack[stack.length-1]\r\n}\r\n\r\n\r\nexport default  Dep","// 把data中的数据 都使用Object.defineProperty 重新定义es5\r\n// Object.defineProperty 不能肩痛ie8 及其一下，也没有什么polyfile\r\nimport { isObject } from '../utils/index'\r\nimport { arrayMethods } from './array'\r\nimport { def } from '../utils/index'\r\nimport Dep from './dep'\r\nclass Observer {\r\n    constructor(value) {\r\n        this.dep = new Dep() // 这是数组专门使用的dep实例，而对象不使用这个。\r\n        // vue如果数据的层次过多，需要递归的去解析对象中的属性，依次增加set和get方法\r\n        // 对数组进行单独的监测\r\n        // 给value对象加上一个ob属性，记录下当前的observer对象\r\n        def(value, '__ob__', this)\r\n        if(Array.isArray(value)) {\r\n            // 如果是数组的话并不会对索引进行监测，因为会导致性能问题\r\n            // 前端开发一般很少会操作索引， 一般会操作数组的 一些方法\r\n\r\n            // 重写这个数组的原型方法\r\n            value.__proto__ = arrayMethods\r\n            // 如果数组里放的是对象我再监测\r\n            this.observerArray(value)\r\n        }else {\r\n            this.walk(value)\r\n        }\r\n    }\r\n    observerArray(value) {\r\n        for(let i =0;i<value.length;i++) {\r\n            observe(value[i]) // 劫持数组中的每一项。\r\n        }\r\n    }\r\n    walk(data) {\r\n        let keys = Object.keys(data)\r\n        for(let i = 0;i<keys.length;i++) {\r\n            let key = keys[i]\r\n            let value = data[key]\r\n            defineReactive(data, key, value)\r\n        }\r\n    }\r\n}\r\n\r\n/* \r\n    正常情况下对一个对象进行取值和赋值操作  是引擎帮我们完成的，我们什么也做不了， \r\n    但是对象经过defineProperty数据劫持后，我们就可以在取值和赋值的内部进行一些操作。\r\n*/\r\nfunction defineReactive(data, key, value) {\r\n    let dep = new Dep()\r\n    let childOb = observe(value) // 进行递归劫持。对深层次(两层以上)的对象进行递归查询其属性并进行数据劫持。\r\n    // 先明确： 如果是数组的话，这步走完就不会往下走了， 而是回到了上面的observerArray，和对象不一样，不仅对象中的属性，该对象也会被get，所以改变对象中的属性和该对象都会触发更新。但是数组不会。\r\n    Object.defineProperty(data, key, {\r\n        get() {     // 获取值时的操作\r\n            // 每个属性都对应着自己的wathcer\r\n            if(Dep.target) { // 是否经过渲染watcher\r\n                // 把当前wathcer 和 Dep建立一个联系\r\n                dep.depend() /// 意味着我要将渲染athcher存起来\r\n\r\n                // 数组的依赖收集\r\n                if(childOb) {\r\n                    childOb.dep.depend() // 收集了数组的依赖，不用担心对象的问题，对象如果有相同的依赖会被过滤掉。\r\n\r\n                    // 如果数组中还有数组, 然后去收集\r\n                    if(Array.isArray(value)) {\r\n                        dependArray(value)\r\n                    }\r\n                }\r\n            }\r\n\r\n            return value\r\n        },\r\n        set(newValue) { // 设置值时的操作\r\n            if(newValue === value) return\r\n            // vm._data.obj = {cc: 123}\r\n            // 上一行说明了，如果用户直接赋值了一个对象的话，需要对这个对象进行劫持。\r\n            value = newValue\r\n\r\n            dep.notify() // 使用notify进行更新。\r\n        }\r\n    })\r\n}\r\nfunction dependArray(value) {\r\n    for(let i =0;i<value.length;i++) {\r\n        let current = value[i]\r\n        current.__ob__ && current.__ob__.dep.depend()\r\n        if(Array.isArray(value[i])) {\r\n            dependArray(value[i])\r\n        }\r\n    }\r\n} \r\nexport function observe(data) {\r\n    // console.log(data)\r\n    if(!isObject(data))  {\r\n        // 抛出错误信息\r\n        // console.error('请返回对象')\r\n        return\r\n    }\r\n\r\n    return new Observer(data)   // 用来对数据进行监测\r\n}","import { observe } from './observer/index.js'\r\n\r\n// 取值时，进行代理，用户更方便\r\nfunction proxy(vm, source, key) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[source][key]\r\n        },\r\n        set(newValue) {\r\n            vm[source][key] = newValue\r\n        }\r\n    })\r\n}\r\nexport function initState(vm) {\r\n    const opts = vm.$options\r\n\r\n    // vue 的数据来源  属性，方法，数据，计算属性，watch\r\n    if(opts.props) {\r\n        initProps(vm)\r\n    }\r\n    if(opts.methods) {\r\n        initMethods(vm)\r\n    }\r\n    if(opts.data) {\r\n        initData(vm)\r\n    }\r\n    if(opts.computed) {\r\n        initComputed(vm)\r\n    }\r\n    if(opts.watch) {\r\n        initWatch(vm)\r\n    }\r\n}\r\n\r\nfunction initProps(vm) {\r\n\r\n}\r\n\r\nfunction initMethods(vm) {\r\n    \r\n}\r\n\r\nfunction initData(vm) {\r\n    // console.log(vm.$options.data)\r\n    // 数据的初始化工作\r\n    let data = vm.$options.data // 用户传递的data\r\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data\r\n\r\n    // 为了让用户更好的使用，我希望可以直接vm.xxx\r\n    for(let key in data) {\r\n        proxy(vm, '_data', key)\r\n    }\r\n    // 对对象进行数据接触， 用户改变了数据， 页面需要得到通知并刷新页面\r\n    // 这就是mvvm模式，数据变化可以驱动视图变化\r\n    // Object.defineProperty()  给属性添加get和set方法\r\n    observe(data)\r\n}\r\n\r\nfunction initComputed(vm) {\r\n    \r\n}\r\n\r\nfunction initWatch(vm) {\r\n    \r\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // abc-aaa  // 命名空间\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // <aaa:asdads>  ?: 代表匹配不捕获\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >  也能是自闭合标签，所以 />\r\n\r\nlet root = null\r\nlet currentParent // 表示当前父亲是谁\r\nlet stack = []\r\nconst ELEMENT_TYPE = 1\r\nconst TEXT_TYPE = 3\r\n\r\nfunction createASTElement (tagName, attrs) {\r\n  return {\r\n    tag: tagName,\r\n    type: ELEMENT_TYPE,\r\n    children: [],\r\n    attrs,\r\n    parent: null\r\n  }\r\n}\r\n\r\n// 在开发中不会使用模版。会降低性能\r\n// 匹配到开始标签\r\nfunction start (tagName, attrs) {\r\n  // 匹配到开始标签，就创建一个ast元素。\r\n  // console.log('开始标签', tagName, '属性', attrs)\r\n  let element = createASTElement(tagName, attrs)\r\n  if (!root) {\r\n    root = element  // root做为一个引用变量，只有在root:null的时候可以被赋值\r\n  }\r\n  currentParent = element // 其他的情况直接将 当前匹配到的element 赋值给currentParent， 不会影响到root了。也就是说root只有一次机会被改变，就是root为null的时候。每匹配到一次开始标签都是一次新的开始。这个匹配到的开始标签就暂时作为了顶层元素，给其children放匹配到的各种子元素，直到遇到结束标签或开始标签，遇到了开始标签的时候就又重新给currentParent赋值了，那么匹配到结束标签是如何确定父子关系的呢？也就是说每一次匹配到开始标签都是新的开始，那么遇到结束标签就需要确定父子关系了，将该元素和该元素匹配到的所有的子元素放到该元素的父元素中，用定义的stack栈结构的数组确定父子关系\r\n  // 将开始标签存放到栈中。\r\n  stack.push(currentParent)\r\n}\r\n// 匹配到文本\r\nfunction chars (text) {\r\n  // console.log('文本是', text)\r\n  text = text.replace(/\\s/g, '')\r\n  // 匹配到文本标签, 就把text放到当前父元素的孩子中。\r\n  if (text) {\r\n    currentParent.children.push({\r\n      text,\r\n      type: TEXT_TYPE\r\n    })\r\n  }\r\n}\r\n// 匹配到结束标签\r\n// <div><p>  [div, p]\r\nfunction end (tagName) {\r\n  // console.log('结束标签', tagName)\r\n  // 将该标签从栈中移出\r\n  let element = stack.pop()\r\n  // 我要标识当前这个p是属于这个div的儿子的\r\n  currentParent = stack[stack.length - 1] // 先看匹配到的end标签是否有父亲。\r\n  // 确定树的父子关系。将该元素和该元素匹配到的所有的子元素放到该元素的父元素中\r\n  if (currentParent) {\r\n    element.parent = currentParent\r\n    currentParent.children.push(element)\r\n  }\r\n}\r\n// 算法题：怎样判断标签都被 正常闭合了，定义一个栈结构[]往里面放开始标签[div, p, span], 当匹配到结束标签，拿出栈中的最后一个进行对比，如果相同，将栈的最后一个删除，如果匹配成功，则是正常的情况，其他的则不是正常的情况， 也是用这个来形成ast语法树，形成父子关系。\r\nexport function parseHTML (html) {\r\n  // 每次调用parseHTML都会产生一颗新的树， 所以将一下变量放到函数体中。\r\n  root = null //  ast语法树的树根\r\n  stack = []\r\n\r\n  /*\r\n      核心规则就是不停的拿正则去匹配template字符串，每匹配到一块就把字符串中匹配到的截取掉 \r\n   */\r\n  while (html) {\r\n    let textEnd = html.indexOf('<')\r\n    if (textEnd === 0) { // 必须是首位代表匹配到了< \r\n      // 如果进来了，那么这能是开始标签也可能是结束标签\r\n      let startTagMatch = parseStartTag() // 通过这个方法获取到匹配的结果，tagName，attrs\r\n      if (startTagMatch) {\r\n        start(startTagMatch.tagName, startTagMatch.attrs)\r\n        // break\r\n        continue // 如果开始标签匹配完毕后，继续下一次匹配\r\n      }\r\n      // 尝试匹配结束标签\r\n      let endTagMatch = html.match(endTag)\r\n      if (endTagMatch) {\r\n        advance(endTagMatch[0].length)\r\n        end(endTagMatch[1])\r\n        continue\r\n      }\r\n    }\r\n\r\n    // 开始标签结束之后，应该尝试再去匹配: 比如<div>xxxxx <p> ，两个标签之间的字符。\r\n    let text\r\n    if (textEnd >= 0) {\r\n      text = html.substring(0, textEnd)\r\n      advance(text.length)\r\n      chars(text)\r\n    }\r\n    // 截取匹配的标签\r\n    function advance (n) {\r\n      html = html.substring(n)\r\n    }\r\n    function parseStartTag () {\r\n      let start = html.match(startTagOpen)\r\n      if (start) {\r\n        const match = {\r\n          tagName: start[1], // 匹配到第一个分组， 在这里就是这个标签名。\r\n          attrs: []\r\n        }\r\n        // console.log(start)\r\n        advance(start[0].length) // start[0] 代表匹配到的结果\r\n\r\n\r\n        let end, attr;\r\n        // 如果开始标签中有>， 并且还能匹配到属性的话那么就开始解析属性\r\n        while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n          advance(attr[0].length) // 将属性去掉\r\n          match.attrs.push({\r\n            name: attr[1],\r\n            value: attr[3] || attr[4] || attr[5]\r\n          })\r\n        }\r\n        if (end) {\r\n          advance(end[0].length) // 将开始标签的> 去掉\r\n          // console.log(html)\r\n          return match\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n  return root\r\n}\r\n","import { parseHTML } from './parse-html.js'\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\nfunction genProps (attrs) {\r\n  let str = ''\r\n  attrs.forEach(item => {\r\n    // 暂时考虑这一种情况\r\n    const { name, value } = item\r\n    if (name === 'style') {\r\n      let obj = {}\r\n      value.split(';').forEach(st => {\r\n        let [name, value] = st.split(':')\r\n        obj[name] = value\r\n      })\r\n      str += `${name}:${JSON.stringify(obj)},`\r\n    } else {\r\n      str += `${name}:${JSON.stringify(value)},`\r\n    }\r\n  });\r\n  return `{${str.slice(0, -1)}}`\r\n}\r\n\r\nfunction genChildren (el) {\r\n  let children = el.children\r\n  if (children && children.length > 0) {\r\n    return `${children.map(c => gen(c)).join(',')}`\r\n  } else {\r\n    return false\r\n  }\r\n}\r\n\r\n// 传过来chilren []中一个个的item\r\nfunction gen (node) {\r\n  if (node.type === 1) {\r\n    return generate(node)\r\n  } else {\r\n    // 这里只能抄了，都是正则匹配问题\r\n    let text = node.text\r\n    let tokens = []\r\n    let match, index;\r\n    let lastIndex = defaultTagRE.lastIndex = 0\r\n    while (match = defaultTagRE.exec(text)) {\r\n      index = match.index\r\n      if (index > lastIndex) {\r\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n      }\r\n      tokens.push(`_s(${match[1].trim()})`)\r\n\r\n      lastIndex = index + match[0] //  每次的偏移量 决定了偏移到的位置,\r\n    }\r\n\r\n    if (lastIndex < text.length) {\r\n      tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n    }\r\n\r\n    return `_v(${tokens.join('+')})`\r\n  }\r\n}\r\n\r\nfunction generate (el) {\r\n  let children = genChildren(el)\r\n  let code = `_c(\"${el.tag}\",${el.attrs.length ? genProps(el.attrs) : 'undefined'}${children ? `,${children}` : ''})`\r\n  return code\r\n}\r\n\r\nexport function compileToFunction (template) {\r\n  // 1） 解析html字符串，将html字符串 =》 ast语法树\r\n  let root = parseHTML(template)\r\n  // console.log(root)\r\n  /* \r\n      <div id=\"app\"><p>hello {{name}}</p> hello</div>\r\n      // 把模版变成ast， 将ast语法树变成render函数\r\n      _c(\"div\", {id: app}, _c(\"p\", undefined, _v('hello' + _s(name))), _v('hello'))\r\n  */\r\n  let code = generate(root)\r\n  // console.log(code)\r\n  // 所有的模板引擎实现 都需要 new Function + with ，with改变作用域\r\n  let renderFn = new Function(`with(this){ return ${code}}`);\r\n\r\n  // 将ast语法树变成render函数\r\n  return renderFn  // 下一步就是将函数执行，然后将函数中数据渲染到页面上。\r\n}\r\n\r\n/*\r\n    首先将拿到的template字符串转成 ast语法树\r\n */\r\n// template 字符串\r\n/*  \r\n<div id=\"app\">\r\n    <p>{{name}}</p>\r\n</div> \r\n */\r\n// 转换成这个样子的ast抽象语法树\r\nlet root1cc = {\r\n  tag: 'div',\r\n  attrs: [{\r\n    name: 'id', value: 'app'\r\n  }],\r\n  parent: null,\r\n  type: 1,\r\n  children: [{\r\n    tag: 'p',\r\n    attrs: [],\r\n    // parent: root, // error so ... comment\r\n    type: 1,\r\n    children: [{\r\n      text: 'hello',\r\n      type: 3\r\n    }]\r\n  }]\r\n}\r\n","import { pushTarget, popTarget } from './dep'\r\nlet id = 0\r\nexport class Watcher {\r\n    constructor(vm,exprOrFn,callback,options){\r\n        this.vm = vm\r\n        this.callback = callback\r\n        this.options = options\r\n\r\n        this.id = id++\r\n        this.getter = exprOrFn // 将内部传递过来的函数放到getter属性上，并不执行，是因为要做其他的逻辑\r\n        // 定义set集合，看wathcer里有没有放过这个dep\r\n        this.depsId = new Set()\r\n        this.deps = []\r\n        this.get()\r\n    }\r\n    // wathcer里不能放重复的dep， dep里不能放重复的watcher\r\n    addDep(dep) {\r\n        let id = dep.id // 拿到dep中唯一的id值。\r\n        if(!this.depsId.has(id)) {\r\n            this.depsId.add(id)\r\n            // 把dep对象存进去\r\n            this.deps.push(dep)\r\n            dep.addSubs(this) // 将当前的watcher存到dep中\r\n        }\r\n    }\r\n    get() {\r\n        pushTarget(this)  // 没渲染之前，把当前watcher存起来。\r\n        // 要做的就是数据改变，自动执行渲染watcher\r\n        this.getter() // 进行渲染, 渲染需要进行取值。\r\n        popTarget() // 渲染之后移除watcher\r\n\r\n    }\r\n    update() {\r\n        this.get()\r\n    }\r\n}","export function patch(oldVnode, vnode) {\r\n    // 在第一次渲染的时候oldVnode一定是一个真实的dom元素。\r\n    // 所以需要判断是更新还是渲染\r\n    const isRealElement = oldVnode.nodeType\r\n\r\n    // 如果是初渲染\r\n    if (isRealElement) {\r\n        const oldElm = oldVnode // div id=\"app\"\r\n        const parentElm = oldElm.parentNode // body\r\n\r\n        let el = createElm(vnode)\r\n        parentElm.insertBefore(el, oldElm.nextSibling) // 通过虚拟dom创建的真实dom插入到oldElm元素的后面。\r\n        parentElm.removeChild(oldElm)\r\n        // 将虚拟dom创建出的真实dom通过oldElm的父亲扔到oldElm的父亲中，然后该父亲将oldElm删除\r\n\r\n        return el\r\n    }\r\n\r\n    \r\n    // 递归创建真实节点。替换掉老的节点\r\n}\r\n\r\n// 根据虚拟节点创建真实的节点\r\nfunction createElm(vnode) {\r\n    let { tag, children, key, data, text } = vnode\r\n    // 是标签就创建标签\r\n    if (typeof tag === 'string') {\r\n        vnode.el = document.createElement(tag)\r\n        // 把属性更新到元素上\r\n        updateProperties(vnode)\r\n        children.forEach(c => {\r\n            vnode.el.appendChild(createElm(c))// 递归创建真实dom\r\n        })\r\n\r\n    } else { // // 如果不是标签就是文本\r\n        // 虚拟dom上映射着真实dom， 方便后续操作更新\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n    return vnode.el\r\n}\r\n\r\n// 将属性更新到元素上，上面那个方式只是创建结构\r\nfunction updateProperties(vnode) {\r\n    let newProps = vnode.data;\r\n    let el = vnode.el;\r\n    for (let key in newProps) {\r\n        if (key === 'style') {\r\n            for (let styleName in newProps.style) {\r\n                el.style[styleName] = newProps.style[styleName];\r\n            }\r\n        } else if (key === 'class') {\r\n            el.className = newProps.class;\r\n        } else {\r\n            el.setAttribute(key, newProps[key]);\r\n        }\r\n    }\r\n}","import { Watcher } from './observer/watcher'\r\nimport { patch } from './vdom/patch'\r\n\r\nexport function lifecycleMixin (Vue) {\r\n  Vue.prototype._update = function (vnode) {\r\n    const vm = this;\r\n    vm.$el = patch(vm.$el, vnode); // 需要用虚拟节点创建出真实节点 替换掉 真实的$el\r\n\r\n  }\r\n}\r\n\r\nexport function mountedComponent (vm, el) {\r\n  const options = vm.$options\r\n\r\n  vm.$el = el  // 代表的是真实的dom元素\r\n\r\n  // 渲染页面之前\r\n  callhook(vm, 'beforeMount')\r\n\r\n  // 渲染页面的函数，渲染函数， 更新组件的函数\r\n  let updateComponent = () => {  // 无论渲染还是更新都会调用此方法\r\n    vm._update(vm._render()) // _render方法返回的是虚拟dom。_update是通过虚拟dom创建出真实的dom。\r\n  }\r\n\r\n  // 渲染watcher   每个组件都有一个watcher\r\n  new Watcher(vm, updateComponent, () => { }, true) // true代表此Watcher是渲染Watcher。 回调是通知谁，这里是渲染Watcher不需要通知谁。\r\n\r\n  // 渲染之后\r\n  callhook(vm, 'mounted')\r\n}\r\n\r\n// 发布的过程， 刚才订阅了一个个的生命周期，现在开始发布\r\nexport function callhook (vm, hook) {\r\n  const handlers = vm.$options[hook]\r\n  if (handlers && Array.isArray(handlers)) {\r\n    for (let i = 0; i < handlers.length; i++) {\r\n      handlers[i].call(vm)\r\n    }\r\n  }\r\n}\r\n","import { initState } from './state'\r\nimport { compileToFunction } from './compiler/index.js' // 模版编译成render函数\r\nimport {mountedComponent, callhook} from './lifecycle' // 执行render函数挂载这个组件\r\n\r\nimport {mergeOptions} from './utils/index'\r\nexport function initMinix(Vue) {\r\n    // 初始化流程\r\n    Vue.prototype._init = function(options) {\r\n        // 数据的劫持\r\n        const vm = this // 在vue中使用this.$options 指代的就是用户传递的属性。\r\n        // vm.$options = options // 将用户传过来的 和 全局的Vue.options进行合并。\r\n        vm.$options = mergeOptions(vm.constructor.options, options)\r\n        // console.log(vm.$options)\r\n        callhook(vm,'beforeCreate')\r\n        // 初始化状态\r\n        initState(vm) // 这个比较重要的处理需要单独拆分出一个文件\r\n        callhook(vm,'created')\r\n\r\n        // 如果用户传入了el属性，需要将页面渲染出来\r\n        // 如果用户传入el，就要实现挂载流程。 \r\n        if(vm.$options.el) {\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n\r\n    Vue.prototype.$mount = function(el) {\r\n        const vm = this\r\n        el = document.querySelector(el)\r\n        const options = vm.$options\r\n        // 默认会先查找有没有render函数，没有render会采用template， template也没有就用el中的内容\r\n        if(!options.render) {\r\n            // 对模版进行编译\r\n            let template = options.template\r\n            if(!template && el) {\r\n                template = el.outerHTML\r\n            }\r\n            const render = compileToFunction(template) // render函数返回的是虚拟dom\r\n            options.render = render\r\n            // console.log(template)\r\n        }\r\n\r\n        // 使用render函数， 渲染/挂载这个组件\r\n        mountedComponent(vm, el) \r\n    }\r\n}","/* \r\n    vnode和ast的区别，大概是ast只能对 语法进行描述，但是vnode可以进行处理包装，比如事件，@click=“clickHandler\"， ast只能对这种结构进行描述，但是vnode可以将事件处理好，放到真实dom上。vnode可以进行包转扩展。但ast只能固有化表示。\r\n*/\r\n\r\nexport function createElement(tag, data = {}, ...children) {\r\n    let key = data.key\r\n    if(key) {\r\n        delete data.key\r\n    }\r\n    return vnode(tag, data, key, children, undefined)\r\n}\r\n\r\nexport function createTextNode(text) {\r\n    return vnode(undefined, undefined, undefined, undefined, text)\r\n}\r\n\r\nfunction vnode(tag, data, key, children, text) {\r\n    return {\r\n        tag,\r\n        data,\r\n        key,\r\n        children,\r\n        text\r\n    }\r\n}","import { createElement, createTextNode } from './vdom/create-element'\r\nexport function renderMixin (Vue) {\r\n\r\n  // _c创建元素的虚拟节点\r\n  // _v 创建文本的虚拟节点\r\n  // _s JSON.stringify\r\n\r\n  Vue.prototype._c = function () {\r\n    return createElement(...arguments) // 创建元素\r\n  }\r\n\r\n  Vue.prototype._v = function (text) {\r\n    return createTextNode(text)\r\n  }\r\n\r\n  Vue.prototype._s = function (val) {\r\n    return val == null ? '' : (typeof val === 'object' ? JSON.stringify(val) : val)\r\n  }\r\n  Vue.prototype._render = function () {\r\n    const vm = this\r\n    const { render } = vm.$options\r\n    console.log(render)\r\n    debugger\r\n    let vnode = render.call(vm) // 去实例上去取值\r\n    return vnode\r\n  }\r\n}\r\n","import { mergeOptions } from '../utils/index'\r\nexport function initGlobalAPI(Vue) {\r\n    // 整合了所有的全局相关的内容\r\n    Vue.options = {}\r\n\r\n    // 这个方法的作用是可以合并一些全局api， 比如生命周期，外面传入一个生命周期函数，不会覆盖内部的。而是对生命周期进行合并\r\n    Vue.mixins = function(mixin) {\r\n        // 这个this肯定指的是Vue\r\n        this.options = mergeOptions(this.options, mixin)\r\n    }\r\n\r\n    // 生命周期的合并  把所有同名的生命周期合并成一个数组 [beforeCreate, beforeCreate], 先放进去的先执行。\r\n    Vue.mixins({\r\n        a: 1,\r\n        created() {\r\n            // console.log('first created')\r\n        },\r\n        beforeCreate() {\r\n            // console.log('first beforeCreate')\r\n        },\r\n        mounted() {\r\n            // console.log('first mounted')\r\n        },\r\n    })\r\n\r\n    Vue.mixins({\r\n        b: 2,\r\n        beforeCreate() {\r\n            // console.log('second beforeCreate')\r\n        },\r\n        mounted() {\r\n            // console.log('second mounted')\r\n        },\r\n        updated() {\r\n            \r\n        },\r\n    })\r\n}","import {initMinix} from './init'\r\nimport { renderMixin } from './render'\r\nimport { lifecycleMixin } from './lifecycle'\r\nimport { initGlobalAPI } from './initGlobalAPI/index'\r\nfunction Vue(options) {\r\n    // 进行vue初始化\r\n    // console.log(options)\r\n    // 进行vue的初始化流程。\r\n    this._init(options)\r\n}\r\n// 通过引入文件的方式， 给Vue原形上添加方法\r\n// 将复杂的流程单独拆分到不同的文件中。流程清晰。\r\ninitMinix(Vue)\r\nrenderMixin(Vue)\r\nlifecycleMixin(Vue)\r\n\r\n\r\n\r\n// 初始化全局 API\r\ninitGlobalAPI(Vue)\r\n\r\nexport default Vue"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","LIFECYCLE_HOOKS","mergeHook","parent","child","concat","strats","forEach","hook","mergeOptions","options","mergeField","hasOwnProperty","oldArrayMethods","Array","prototype","arrayMethods","create","methods","method","inserted","args","slice","__ob__","observerArray","result","apply","dep","notify","id","Dep","subs","target","addDep","watcher","push","update","stack","pushTarget","popTarget","pop","length","Observer","isArray","__proto__","walk","i","observe","keys","defineReactive","childOb","get","depend","dependArray","set","newValue","current","proxy","vm","source","initState","opts","$options","props","initData","computed","watch","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","root","currentParent","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","tag","type","children","start","element","chars","text","replace","end","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","str","item","obj","split","st","JSON","stringify","genChildren","el","map","c","gen","join","node","generate","tokens","index","lastIndex","exec","trim","code","compileToFunction","template","renderFn","Function","Watcher","exprOrFn","callback","getter","depsId","Set","deps","has","add","addSubs","patch","oldVnode","vnode","isRealElement","nodeType","oldElm","parentElm","parentNode","createElm","insertBefore","nextSibling","removeChild","document","createElement","updateProperties","appendChild","createTextNode","newProps","styleName","style","className","setAttribute","lifecycleMixin","Vue","_update","$el","mountedComponent","callhook","updateComponent","_render","handlers","initMinix","_init","constructor","$mount","querySelector","render","outerHTML","undefined","renderMixin","_c","arguments","_v","_s","val","console","log","initGlobalAPI","mixins","mixin","a","created","beforeCreate","mounted","b","updated"],"mappings":"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"}